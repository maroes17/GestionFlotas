<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
  crossorigin="anonymous"
  type="text/javascript"
></script>
<script
  src="https://code.jquery.com/jquery-3.7.1.js"
  type="text/javascript"
></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/2.2.2/js/dataTables.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/2.2.2/js/dataTables.bootstrap5.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/responsive/3.0.4/js/dataTables.responsive.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/responsive/3.0.4/js/responsive.bootstrap5.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/buttons/3.2.2/js/dataTables.buttons.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/buttons/3.2.2/js/buttons.dataTables.js"
  type="text/javascript"
></script>
<script
  src="https://cdn.datatables.net/buttons/3.2.2/js/buttons.colVis.min.js"
  type="text/javascript"
></script>

<script>
  //Activar / Desactivar Botón Hamburguesa Menú
  const hamburger = document.querySelector("#toggle-btn");

  hamburger.addEventListener("click", function () {
    document.querySelector("#sidebar").classList.toggle("expand");
  });

  // Escuchar el click en los enlaces del menú
  document.querySelector("#flotaLink").addEventListener("click", function () {
    loadTableData("Flota"); // Llamamos a la función con el nombre de la hoja "Flota"
  });

  document
    .querySelector("#choferesLink")
    .addEventListener("click", function () {
      loadTableData("Choferes"); // Llamamos a la función con el nombre de la hoja "Choferes"
    });

  // Función para cargar los datos desde Google Sheets (con nombre de hoja)
  function loadTableData(sheetName) {
    google.script.run
      .withSuccessHandler(function (object) {
        // Cargar los nuevos datos en la tabla
        updateTable(object.headers, object.datos);
      })
      .getData(sheetName); // Enviar el nombre de la hoja al servidor
  }

  // Función para actualizar la tabla DataTable
  function updateTable(headers, datos) {
    // Verificamos si ya existe la tabla y la destruimos antes de crearla nuevamente
    if ($.fn.dataTable.isDataTable("#tablaPrueba")) {
      $("#tablaPrueba").DataTable().clear().destroy(); // Destruir la tabla anterior
    }

    // Configuramos las nuevas columnas basadas en los headers
    const formattedCols = headers.map((header) => {
      return { title: header };
    });

    // Creamos la nueva DataTable con los nuevos datos
    new DataTable("#tablaPrueba", {
      responsive: true,
      layout: {
        topStart: {
            buttons: [{
              extend: 'colvis',
              text: "Columnas"
            }]
        }
    },
      language: {
        url: "//cdn.datatables.net/plug-ins/2.2.2/i18n/es-CL.json",
      },
      columns: formattedCols,
      data: datos,
    });
  }
</script>
